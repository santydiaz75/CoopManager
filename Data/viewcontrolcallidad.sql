CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `coopmanagerdb`.`viewcontrolcalidad` AS select `e`.`Empresa` AS `Empresa`,`e`.`Ejercicio` AS `Ejercicio`,`e`.`Semana` AS `Semana`,`coopmanagerdb`.`EntradasGetFechaGrupoCosechero`(`e`.`Empresa`,`e`.`Ejercicio`,`e`.`Semana`,`c`.`IdGrupo`) AS `Fecha`,`c`.`IdGrupo` AS `IdCosechero`,`c`.`NIF` AS `NIF`,`coopmanagerdb`.`CosecheroGetNombreByNif`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`NIF`) AS `NombreApellidos`,`s`.`RefAutoControl` AS `RefAutoControl`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,1)) AS `NumKIlos1`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,2)) AS `NumKIlos2`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,3)) AS `NumKIlos3`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,4)) AS `NumKIlos4`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,5)) AS `NumKIlos5`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,6)) AS `NumKIlos6`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,7)) AS `NumKIlos7`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,8)) AS `NumKIlos8`,`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,9)) AS `NumKIlos9`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,1)) / 16) AS `NumCajas1`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,2)) / 9) AS `NumCajas2`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,3)) / 16) AS `NumCajas3`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,4)) / 10) AS `NumCajas4`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,5)) / 9) AS `NumCajas5`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,6)) / 16) AS `NumCajas6`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,7)) / 9) AS `NumCajas7`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,8)) / 10) AS `NumCajas8`,(`coopmanagerdb`.`EntradasKilosGrupoCosecheroCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,`c`.`IdGrupo`,`e`.`Semana`,`coopmanagerdb`.`ControlCalidadGetCategoria`(`e`.`Empresa`,`e`.`Ejercicio`,9)) / 10) AS `NumCajas9` from ((`coopmanagerdb`.`entradascabecera` `e` left join `coopmanagerdb`.`cosecheros` `c` on(((`e`.`IdCosechero` = `c`.`IdCosechero`) and (`e`.`Empresa` = `c`.`Empresa`) and (`e`.`Ejercicio` = `c`.`Ejercicio`)))) left join `coopmanagerdb`.`calendario` `s` on(((`s`.`Semana` = `e`.`Semana`) and (`s`.`Empresa` = `e`.`Empresa`) and (`s`.`Ejercicio` = `e`.`Ejercicio`))))